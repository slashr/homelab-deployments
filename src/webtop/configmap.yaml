apiVersion: v1
kind: ConfigMap
metadata:
  name: webtop-scripts
  namespace: webtop
data:
  setup-mouse-jiggler.sh: |
    #!/bin/bash
    # Alpine-compatible mouse jiggler setup
    # xdotool is already installed in the webtop image

    # Create the mouse jiggler script
    cat > /usr/local/bin/mouse-jiggler.sh << 'SCRIPT'
    #!/bin/bash
    export DISPLAY=:1
    xdotool mousemove_relative -- 1 1
    sleep 0.1
    xdotool mousemove_relative -- -1 -1
    SCRIPT
    chmod +x /usr/local/bin/mouse-jiggler.sh

    # Add cron job to run every 10 minutes (Alpine crontab format)
    (crontab -l 2>/dev/null; echo "*/10 * * * * /usr/local/bin/mouse-jiggler.sh") | crontab -

    # Start crond if not already running (Alpine uses /usr/sbin/crond)
    pgrep crond || /usr/sbin/crond
